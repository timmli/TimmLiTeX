\usepackage{datetime}

% Font & Encoding
\usepackage{libertine}
\usepackage[T1]{tipa}		% IPA symbols 
\usepackage[libertine]{newtxmath}
\usepackage{microtype}		% micro-typographic aspects of the fonts
\usepackage[T1]{fontenc}	% special fonts, e.g. for German umlaute
\usepackage{ucs}
\usepackage[utf8x]{inputenc}
\usepackage[scaled=0.83]{beramono}  % for monospaced font

% Language
\usepackage[ngerman]{babel}	% uncomment for German

% Trees and graphics
\usepackage{graphics,tikz}
\usepackage{multirow}		% similar to \multicolumn

% Symbols
\usepackage{latexsym,amsmath,amssymb,wasysym}
\usepackage{marvosym}		% for thunderbolt and Euro symbol
\usepackage{ulem}			% to cross out text
\normalem
\usepackage{url}
\urlstyle{sf}

% Linguistics
\usepackage{linguex}
\usepackage[inference]{semantic} % for CCG 
\usepackage{packages/ccg} 
\usepackage{tipa}
%%%%%%%%%%%%%%%%%%%%%%
%   AVM SETTINGS     % 
%%%%%%%%%%%%%%%%%%%%%%

\usepackage{packages/avm}

\avmoptions{center} 
\avmfont{\scshape}
\avmvalfont{\normalfont}
\avmsortfont{\normalfont\itshape}

\newenvironment{topbot}{   	% more flexible than /newcommand ?
	\avmvskip{0.2ex} 
	\hspace{-1.5em}
	\begin{avm}
	\avml
	}
	%%%
	{
	\avmr
    \end{avm}
    \hspace{-0.5em}
}
%%%%%%%%%%%%%%%%%%%%%%% 
%   FOREST SETTINGS   % 
%%%%%%%%%%%%%%%%%%%%%%% 

\usepackage{forest}

\makeatletter

\@ifpackagelater{forest}{2016/01/01}
{\useforestlibrary{linguistics}%
 \useforestlibrary{edges}}
{}

\@ifpackagelater{forest}{2016/01/01}
{\newcommand{\forestPreamble}{default preamble}} % version >=2 of forest
{\newcommand{\forestPreamble}{.style}} % version <=1 of forest

\makeatother

\forestset{
  \forestPreamble ={
    % .style={ % version <=1 of forest
    % default preamble={ % version >=2 of forest    
		for tree={
			parent anchor=south, 
			child anchor=north,
			% align=center,			% bad: adds space below label
			fit=rectangle,
			base=top,				% vertical orientation of nodes
			% inner sep=3,			% necesssary?
			begin draw/.code={\begin{tikzpicture}[baseline=(current bounding box.center)]},
    }},
  htree/.style={for tree={grow'=east,parent anchor=east,child anchor=west,anchor=base west}},
  sn edges/.style={for tree={parent anchor=south, child anchor=north}},
  red subtree/.style={for tree={text=red},for descendants={edge=red}},
  black subtree/.style={for tree={text=black},for descendants={edge=black}},
  blue subtree/.style={for tree={text=blue},for descendants={edge=blue}},
  green subtree/.style={for tree={text=green},for descendants={edge=green}},
  gray subtree/.style={for tree={text=gray},for descendants={edge=gray}},
  vcenter/.style={begin draw/.code={\begin{tikzpicture}[baseline=(current bounding box.center)]}},
  empty nodes/.style={	% from the forest manual
    for tree={
      % calign=fixed edge angles,
      yshift=1ex},
    delay={where content={}{shape=coordinate,for parent={for children={anchor=north}}}{}}},
  derivation tree/.style={.style={
      for tree={parent anchor={},child anchor={},font=\ttfamily}}},
  dt label/.style 2 args={
    edge label={node[midway,font=\ttfamily\scriptsize, #1]{#2}},},
  %% for drawing STUG sequences
  %% conn, <-- and --> are take from https://tex.stackexchange.com/a/414444/61499
  conn/.style n args=2{
    tikz+={\draw [dashed] (#1) -- (#2);}
  },
  -->/.style={ % draw horizontal line to predecessor
    before drawing tree={
      temptoksa=,
      tempcounta/.option=level,
      if nodewalk valid={n}{conn={}{!n}}{
        for nodewalk={
          while nodewalk valid={u}{
            tempcountb/.option=n,
            u,
            if={> OR>{n children}{tempcountb} }{
              tempcountc/.register=tempcountb,
              tempcountc'+=1,
              n/.register=tempcountc,
              while nodewalk valid={1}{
                1,
                if={ > OR= {level}{tempcounta} }{
                  temptoksa/.option=name,
                  break=1
                }{}
              }
            }{}
          }
        }{},
        if temptoksa={}{}{conn/.process={_R {}{temptoksa}}}
      },
    },
  },
  <--/.style={ % draw horizontal line to successor
    before drawing tree={
      temptoksa=,
      tempcounta/.option=level,
      if nodewalk valid={p}{conn={}{!p}}{
        for nodewalk={
          while nodewalk valid={u}{
            u,
            if n=1{}{
              p,
              while nodewalk valid={1}{
                1,
                if={ > OR= {level}{tempcounta} }{
                  temptoksa/.option=name,
                  break=1
                }{}
              }
            },
          }
        }{},
        if temptoksa={}{}{conn/.process={_R {}{temptoksa}}}
      },
    },
  },
  t/.style={calign with current}, % trunk 
  lex/.style={                    % terminal nodes with lexical material
    no edge,
    for parent={l sep=0ex},
    yshift=3ex,
    draw=gray,
    content={\textit{##1}}},
  c/.style args={#1}{            % visual link with argument
    % edge label={node[xshift={0.8em},scale=0.8,fill=white,draw,inner sep=.10ex,circle]{#1}}
    % tikz={\node[yshift={1.5ex},scale=0.8,fill=white,draw,inner sep=.10ex,circle, right=-0.5em of .east]  {1};}
    label={[yshift={0.5ex},scale=.8,circle, draw, fill=white, inner sep=.1ex, label distance=-.65em, anchor=west]north east:#1}},
  Xs/.style={for tree={xshift=#1}},
  Ys/.style={for tree={yshift=#1}}
}


% BibTex
\usepackage{natbib}
\setcitestyle{notesep={: $\!$}} 

% Hyperrefs in PDF 
\usepackage[bookmarks=true,bookmarksopen=true,%
hyperindex=true,%
breaklinks=true,
draft=false,plainpages=false,
pdfauthor={},%
pdfkeywords={},%
]{hyperref}
\hypersetup{colorlinks=false, pdfborder={0 0 0}}

\usepackage{lipsum}
